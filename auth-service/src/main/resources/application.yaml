spring:
  application:
    name: auth-service
  
  # Active profile - can be overridden by SPRING_PROFILES_ACTIVE env var
  profiles:
    active: ${SPRING_PROFILES_ACTIVE:dev}
  
  # Import configuration from Config Server and Vault
  config:
    import: 
      - optional:configserver:http://${CONFIG_SERVER_USER:config}:${CONFIG_SERVER_PASSWORD:config123}@${CONFIG_SERVER_HOST:localhost}:${CONFIG_SERVER_PORT:8888}
      - optional:vault://

  # Vault Configuration
  cloud:
    vault:
      uri: ${VAULT_URI:http://localhost:8200}
      token: ${VAULT_TOKEN:ecom-root-token}
      kv:
        enabled: true
        backend: secret
        default-context: ecommerce/auth-service
        application-name: auth-service
        profiles:
          - ecommerce/services/auth-service
          - ecommerce/database/postgres
          - ecommerce/database/redis
    
    # Config Server fallback
    config:
      fail-fast: false
      retry:
        max-attempts: 3

# Service-to-Service Authentication Config
service:
  name: auth-service
  client-id: ${service-name:auth-service}
  client-secret: ${client-secret:}
  jwt-key: ${service-jwt-key:}
  token-expiration: ${service-token-expiration:3600}
  # Credentials for other services (loaded from Vault or env)
  credentials:
    product-service:
      client-secret: ${SERVICE_PRODUCT_SECRET:}
    order-service:
      client-secret: ${SERVICE_ORDER_SECRET:}
    user-service:
      client-secret: ${SERVICE_USER_SECRET:}
    api-gateway:
      client-secret: ${SERVICE_GATEWAY_SECRET:}
