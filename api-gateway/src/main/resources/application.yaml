spring:
  application:
    name: api-gateway
  
  # Import configuration from Config Server and Vault
  config:
    import: 
      - optional:configserver:http://${CONFIG_SERVER_USER:config}:${CONFIG_SERVER_PASSWORD:config123}@${CONFIG_SERVER_HOST:localhost}:${CONFIG_SERVER_PORT:8888}
      - optional:vault://

  # Vault Configuration
  cloud:
    vault:
      uri: ${VAULT_URI:http://localhost:8200}
      token: ${VAULT_TOKEN:ecom-root-token}
      kv:
        enabled: true
        backend: secret
        default-context: ecommerce/api-gateway
        application-name: api-gateway
        # Also load common secrets (includes Redis password)
        profiles:
          - ecommerce/common
          - ecommerce/database/redis
    
    # Config Server fallback
    config:
      fail-fast: false
      retry:
        max-attempts: 3
